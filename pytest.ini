[pytest]
# Pytest Configuration for Python Sprite Viewer
# Professional testing setup with markers, coverage, and CI integration

# Test discovery  
testpaths = tests
# Exclude archive and development files
norecursedirs = archive archive/* build dist *.egg .tox venv __pycache__
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Minimum version requirements
minversion = 7.0

# Additional options (Qt-optimized)
addopts = 
    --strict-markers
    --strict-config
    --verbose
    --tb=short
    --durations=10
    --maxfail=3
    --disable-warnings
    -p no:cacheprovider
    --ignore=archive/

# Test markers for organization
markers =
    unit: Unit tests (fast, isolated components)
    integration: Integration tests (multi-component workflows)
    ui: UI component tests (requires Qt/display)
    performance: Performance and load tests
    slow: Tests that take more than 2 seconds
    smoke: Critical functionality smoke tests
    regression: Regression tests for bug fixes
    requires_files: Tests requiring test sprite files or file I/O
    memory_intensive: Tests that use significant memory
    requires_qt: Tests requiring Qt event loop
    requires_threading: Tests with threading/async operations
    platform_specific: Platform-specific tests
    signal_test: Tests for Qt signal/slot connections
    benchmark: Performance benchmark tests
    
    # Component-specific markers
    sprite_model: Tests for sprite model components
    animation: Animation system tests
    detection: Auto-detection algorithm tests  
    file_ops: File operation tests
    config: Configuration system tests
    
    # Phase 4 markers
    phase4: Phase 4 Enhanced Live Preview System tests
    visual_preview: Visual preview widget tests
    layout_calculation: Layout algorithm tests
    export_integration: Export dialog integration tests
    preview_performance: Preview system performance tests
    
    # Test environment markers
    requires_display: Tests requiring GUI display
    requires_files: Tests requiring test sprite files
    memory_intensive: Tests that use significant memory

# Filters and warnings (Qt-optimized)
filterwarnings =
    error
    ignore::UserWarning
    ignore::DeprecationWarning:pkg_resources.*
    ignore::PendingDeprecationWarning
    ignore:.*QApplication.*:DeprecationWarning
    ignore:.*Qt.*:DeprecationWarning
    ignore:.*PySide6.*:DeprecationWarning
    ignore:.*shiboken6.*:DeprecationWarning
    ignore::pytest.PytestUnraisableExceptionWarning
    ignore:.*unclosed.*:ResourceWarning
    ignore:.*QObject.*:RuntimeWarning
    ignore:.*QThread.*:RuntimeWarning
    ignore:.*QPixmap.*:RuntimeWarning
    ignore:.*QWidget.*:RuntimeWarning

# Timeout configuration is handled via --timeout flags in addopts above

# Coverage configuration
[coverage:run]
source = .
omit = 
    venv/*
    __pycache__/*
    *.pyc
    tests/*
    archive/*
    build/*
    dist/*
    .tox/*
    setup.py
    */tests/*
    */test_*
    */conftest.py
    */__init__.py

[coverage:report]
exclude_lines =
    pragma: no cover
    def __repr__
    raise AssertionError
    raise NotImplementedError
    if __name__ == .__main__.:
    if TYPE_CHECKING: